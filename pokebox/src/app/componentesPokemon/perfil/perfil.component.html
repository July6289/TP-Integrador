<div class="user-card">
  <div class="user-card-header">
    <h2>Perfil de Usuario</h2>
  </div>

  <div class="user-card-body">
    @if(isCardShowing){
    <div class="user-content">
      <!-- Columna izquierda - Información del usuario -->
      <div class="user-info-list">
        <div class="user-info">
          <label>Email:</label>
          <span>{{ usuario.Email }}</span>
          <label> Nombre de Usuario</label>
          <span>{{usuario.Username}}</span>
        </div>

        <div class="user-info">
          @if (isLoggedWithouthGoogle) {
          <label>Contraseña:</label>
          <span>{{ usuario.Password }}</span>
          }
          @else {
          <p style="color: green">Usuario autenticado con Google!</p>
          }
        </div>

        <div class="user-info">
          <label>Combates Ganados:</label>
          <span>{{ usuario.CombatesGanados }}</span>
        </div>
      </div>

      <!-- COLUMNA DERECHA: Imagen + botón -->
      <div class="trainer-container">
        <button class="btn-change-avatar" (click)="mostrarSelector()">Cambiar Avatar</button>
        <div class="trainer-image-container">
          <img class="Image-trainer" [src]="selectedAvatar" alt="Imagen del entrenador">
        </div>
      </div>

    </div>
    <!-- Botones de acción -->
    <div class="action-buttons">
      @if(isLoggedWithouthGoogle) {
      <button class="btn-modify-account" (click)="toggleModify()">Modificar Perfil</button>
      }
      <button class="btn-delete-account" (click)="toogleDelete()">Eliminar Cuenta</button>
    </div>
    }
    <!-- Formulario de modificación, solo se muestra si isModifyShowing es verdadero -->
    @if(isModifyShowing) {
    <div class="modify-profile">
      <h3 class="modify-title">Modificando tu Perfil</h3>
      <form class="formularioRegistro" [formGroup]="formulario" (ngSubmit)="addUsuario()"
        (keydown.enter)="addUsuario()">
        <!-- Campo de Email -->
        <div class="form-group">
          <label for="">Correo electronico:</label>
          <input type="text" formControlName="Email">
         <p class="Error" [class.visible]="formulario.controls['Email'].touched&&formulario.controls['Email'].errors">


    @if(formulario.controls['Email'].hasError('required')&&formulario.controls['Email'].touched)
      {

        <span>Se debe llenar el campo requerido</span>
      }


    @if (formulario.controls['Email'].getError('minlength')&&formulario.controls['Email'].touched) {
    <span>El usuario no puede contener un minimo de 6 letras</span>
    }
    </p>
        </div>

        <!-- Campo de Usuario -->
        <div class="form-group">
          <label for="">Nombre de Usuario:</label>
          <input type="text" formControlName="Username">
         <p class="Error" [class.visible]="formulario.controls['Username'].touched&&formulario.controls['Username'].errors">


        @if(formulario.controls['Username'].hasError('required')&&formulario.controls['Username'].touched)
           {

            <span>Se debe llenar el campo requerido</span>
            }


        @if (formulario.controls['Username'].getError('minlength')&&formulario.controls['Username'].touched) {
           <span>El usuario no puede contener un minimo de 6 letras</span>
           }
        </p>
        </div>

        <!-- Campo de Contraseña -->
        <div class="form-group">
          <label for="">Contraseña:</label>
          <input type="text" formControlName="Password">
          <p class="Error" [class.visible]="formulario.controls['Password'].touched&&formulario.controls['Password'].errors">


    @if(formulario.controls['Password'].hasError('required')&&formulario.controls['Password'].touched)
      {

        <span>Se debe llenar el campo requerido</span>
      }


    @if (formulario.controls['Password'].getError('minlength')&&formulario.controls['Password'].touched) {
    <span>El usuario no puede contener un minimo de 6 letras</span>
    }
    </p>
        </div>

        <!-- Mensaje de error adicional -->
        @if (validadorMensajeEspecifico&&!formulario.invalid) {
          <span>{{MensajeEspecifico}}</span>
          }

        <!-- Botones para cancelar o confirmar cambios -->
        <div class="botones">
          <button class="SalirRegistro" (click)="cancelar()">Cancelar</button>
          <button class="Confirmar" (click)="addUsuario()">Confirmar</button>
        </div>
      </form>
    </div>
    }
    @if (isDeleteShowing) {
    <div class="delete-confirmation">
      <p>¿Estás seguro de que quieres eliminar tu cuenta?</p>
      <div class="confirmation-buttons">
        <button class="btn-confirm-delete" (click)="confirmDelete()">Sí, eliminar</button>
        <button class="btn-cancel-delete" (click)="cancelDelete()">Cancelar</button>
      </div>
    </div>
    }

    @if (mostrarSelectorAvatar) {
    <label class="mensajeSelector">Selecciona tu Avatar:</label>
    <div class="avatar-selector">
      <div class="avatar-options">
        <img *ngFor="let avatar of avatarList" [src]="avatar" [class.selected]="selectedAvatar === avatar"
          (click)="seleccionarAvatar(avatar)" alt="Avatar">
      </div>
    </div>
    }
  </div>
</div>
